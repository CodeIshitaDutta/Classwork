---
title: "Report"
output: pdf_document
author: Justin Lu
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

2.

A)

```{r}
vector_function <- function(vector) {
  mean_value = mean(vector)
  standard_dev = sd(vector)
  
  # initialize newVector
  n = length(vector)
  newVector = seq(1,n)
  # then loop vector and move values to new vector
  for(x in 1:n){
    value = (vector[x] - mean_value) / standard_dev
    newVector[x] = value
  }
    
  new_sd = sd(newVector)
  return(new_sd)
}
sampleVector = seq(1,100)
vector_function(sampleVector)
```

B)

```{r}
vector_function2 <- function(vector) {
  mean_value = mean(vector)
  standard_dev = sd(vector)
  Lower = mean_value - (2*standard_dev)
  Upper = mean_value + (2*standard_dev)
  answer = list("upper" = Upper, "Lower" = Lower)
  return (answer)
}
sampleVector = seq(1,100)
vector_function2(sampleVector)
```

c)

My custom function takes in a vector and returns the greatest value
inside of it 
```{r}
custom_function <- function(vector) {
  max = 0
  n = length(vector)
  for(x in 1:n){
    if (vector[x] > max){
      max = vector[x]
    } 
  }
  return (max)
}
sampleVector = seq(1,100)
sampleVector2 = c(3,54,21,-22,321,0,100,911192,32,321,32,1,8)
custom_function(sampleVector)
custom_function(sampleVector2)
```

3.

```{r , include=FALSE}
crimes = read.csv("crime.csv")
crimes
```

A)
```{r}
dip = crimes$dip
crimeRate = crimes$rate
plot(x = dip, y = crimeRate, xlab="High School Diploma %", ylab="Crime Rate" , main = "HS Diploma % vs Crime Rate")
```

B)

Yes, there does appear to be a outliers in our plot.
Based off of the scatter plot, ## 27 14016  78 (Row 27) and ## 37  2105  77 (Row 37) appear to be an outliers.
Thus we will remove these outliers and replot our values.

```{r}
crimes <- crimes[-c(27,37),]
dip = crimes$dip
crimeRate = crimes$rate

plot(x = dip, y = crimeRate, xlab="High School Diploma %", ylab="Crime Rate" , main = "HS Diploma % vs Crime Rate")
abline(lm(crimeRate ~ dip))
```



C)
```{r}
lm(crimeRate ~ dip)
```

D)

The slope is = -171.9
The intercept is = 20605.1

For our problem, let us interpret this.
Starting with slope we can say that, when our X variable ( Diploma %)
increases by 1 percent, based on our regression line, the average crime rate
decreases by 171.9.

To interpret our intercept, 20605.1 is essentially that number to fit our line.
Since our regression line is given as y = mx + b, our y intercept (b) is where the line
would be when x is = to 0. In this case it logically does not have any relevance, 
and is just pertaining to our specific data set.

E)

```{r}
residuals = resid(lm(crimeRate ~ dip))

qqnorm(residuals, pch = 1, frame = FALSE)
qqline(residuals, col = "steelblue", lwd = 2)
```

Yes are graph does appear to be normally distributed. For the most part 
our graph follows our line and the deviation is minimal, meaning we have a normal distribution.
We can safely deduce that our data set originates from a normal distribution.

F)

```{r}
fittedValues = fitted(lm(crimeRate ~ dip))
plot(fittedValues, residuals, ylab="Residuals", xlab="crime rate" ) 
```

Yes, the variance of the errors does appear to be constant. Since our graph is scattered
and we do not observe a relationship of any kind, we have a mean of 0 and the variance is constant.

G)

```{r}
reg_line = lm(crimeRate ~ dip)
confint(reg_line,'dip',level=0.95)
```

Yes since our slope was -171 between our interval, we can thus conclude that
our slope was significant and thus we have a valid linear relationship.
