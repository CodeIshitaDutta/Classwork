options(knitr.kable.NA = ''), #do not print NA in knitr table
tidy = FALSE #add line breaks in R codes
)
CDI = read.table("CDI.txt")
#"ID", "County", "State", "Area", "Population", "18_to_34", "65+", "Active_Physicians", "Beds", "Serious_Crimes", "High_School_Grad", "Bachelors_Degree", "Under_Poverty_Line", " Unemployed", "Per_Capita_Income", "Total_Income", "Region"
X1 = CDI[,5] #Population in Hundred Thousands
X1 = X1
X2 = CDI[,9] #Number of Hospital Beds in Thousands
X2 = X2
X3 = CDI[,16] #Personal Income in Ten Thousands
X3 = X3
Y = CDI[,8]
n = length(X1)
cat("Population(In Hundred Thousands): \n")
b1hat1 = t(X1-mean(X1))%*%(Y-mean(Y))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y) - b1hat1*mean(X1)
cat("Y = ", b0hat1, " + ", b1hat1, "x\n")
cat("Number of Hospital Beds(In Thousands): \n")
b1hat2 = t(X2-mean(X2))%*%(Y-mean(Y))/sum((X2-mean(X2))^2)
b0hat2 = mean(Y) - b1hat2*mean(X2)
cat("Y = ", b0hat2, " + ", b1hat2, "x\n")
cat("Personal Income(In Ten Thousands): \n")
b1hat3 = t(X3-mean(X3))%*%(Y-mean(Y))/sum((X3-mean(X3))^2)
b0hat3 = mean(Y) - b1hat3*mean(X3)
cat("Y = ", b0hat3, " + ", b1hat3, "x\n")
par(mfrow=c(1,3))
plot(X1, Y, xlab="Population", ylab="Number of Active Physicians" , main = "Population vs\nNumber of Physicians")
abline(lm(Y ~ X1))
plot(X2, Y, xlab="Number of Hospital Beds", ylab="Number of Active Physicians" , main = "Number of Hospital Beds vs\nNumber of Physicians")
abline(lm(Y ~ X2))
plot(X3, Y, xlab="Personal Income", ylab="Number of Active Physicians" , main = "Personal Income vs\nNumber of Physicians")
abline(lm(Y ~ X3))
fit.y1 = b0hat1[1] + b1hat1[1]*X1
mse1 = 1/(n-2)*sum((Y - fit.y1)^2)
cat("MSE for Population Measured in Hundred Thousands: ", mse1, "\n")
fit.y2 = b0hat2[1] + b1hat2[1]*X2
mse2 = 1/(n-2)*sum((Y - fit.y2)^2)
cat("MSE for Number of Hospital Beds Measured in Thousands: ", mse2, "\n")
fit.y3 = b0hat3[1] + b1hat3[1]*X3
mse3 = 1/(n-2)*sum((Y - fit.y3)^2)
cat("MSE for Personal Income Measured in Ten Thousands: ", mse3, "\n")
Reg_1 <- subset(CDI, CDI[,17] == 1)
RX1 = Reg_1[,12]
RY1 = Reg_1[,15]
R1n = length(RX1)
fitr1 = lm(RY1 ~ RX1)
cat("Y = 9223.82 + 522.16x\n")
Reg_2 <- subset(CDI, CDI[,17] == 2)
RX2 = Reg_2[,12]
RY2 = Reg_2[,15]
R2n = length(RX2)
fitr2 = lm(RY2 ~ RX2)
cat("Y = 13581.41 + 238.67x\n")
Reg_3 <- subset(CDI, CDI[,17] == 3)
RX3 = Reg_3[,12]
RY3 = Reg_3[,15]
R3n = length(RX3)
fitr3 = lm(RY3 ~ RX3)
cat("Y = 10529.79 + 330.61x\n")
Reg_4 <- subset(CDI, CDI[,17] == 4)
RX4 = Reg_4[,12]
RY4 = Reg_4[,15]
R4n = length(RX4)
fitr4 = lm(RY4 ~ RX4)
cat("Y = 8615.05 + 440.32x\n")
R1b1hat1 = t(RX1-mean(RX1))%*%(RY1-mean(RY1))/sum((RX1-mean(RX1))^2)
R1b0hat1 = mean(RY1) - R1b1hat1*mean(RX1)
R1fit = R1b0hat1[1] + R1b1hat1[1]*RX1
R1mse = 1/(R1n-2)*sum((RY1 - R1fit)^2)
cat("MSE for Region 1: ", R1mse, "\n")
R2b1hat1 = t(RX2-mean(RX2))%*%(RY2-mean(RY2))/sum((RX2-mean(RX2))^2)
R2b0hat1 = mean(RY2) - R2b1hat1*mean(RX2)
R2fit = R2b0hat1[1] + R2b1hat1[1]*RX2
R2mse = 1/(R2n-2)*sum((RY2 - R2fit)^2)
cat("MSE for Region 2: ", R2mse, "\n")
R3b1hat1 = t(RX3-mean(RX3))%*%(RY3-mean(RY3))/sum((RX3-mean(RX3))^2)
R3b0hat1 = mean(RY3) - R3b1hat1*mean(RX3)
R3fit = R3b0hat1[1] + R3b1hat1[1]*RX3
R3mse = 1/(R3n-2)*sum((RY3 - R3fit)^2)
cat("MSE for Region 3: ", R3mse, "\n")
R4b1hat1 = t(RX4-mean(RX4))%*%(RY4-mean(RY4))/sum((RX4-mean(RX4))^2)
R4b0hat1 = mean(RY4) - R4b1hat1*mean(RX4)
R4fit = R4b0hat1[1] + R4b1hat1[1]*RX4
R4mse = 1/(R4n-2)*sum((RY4 - R4fit)^2)
cat("MSE for Region 4: ", R4mse, "\n")
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSR = sum((y_hat1 - mean(Y))^2)
SSTO = sum (((Y - mean(Y)))^2)
R2a = SSR / SSTO
cat("R ^ 2 = ", R2a, "\n")
fit2 = lm(Y~X2)
y_hat2 = fit2$fitted.values
SSR = sum((y_hat2 - mean(Y))^2)
SSTO = sum (((Y - mean(Y)))^2)
R2b = SSR / SSTO
cat("R ^ 2 = ", R2b, "\n")
fit3 = lm(Y~X3)
y_hat3 = fit3$fitted.values
SSR = sum((y_hat3 - mean(Y))^2)
SSTO = sum (((Y - mean(Y)))^2)
R2c = SSR / SSTO
cat("R ^ 2 = ", R2c, "\n")
library (knitr)
confint(fitr1, parm = "RX1",  level = 0.90)
confint(fitr2, parm = "RX2",  level = 0.90)
confint(fitr3, parm = "RX3",  level = 0.90)
kable(anova(fitr2))
kable(anova(fitr3))
kable(anova(fitr4))
par(mfcol = c(2, 3), no.readonly = TRUE)
R2a = fit1$residuals
plot(X1, y = R2a, xlab='Population', ylab='residuals')
abline(h=0, col='red')
qqnorm(R2a)
qqline(R2a, col='green')
R2b = fit2$residuals
plot(X1, y = R2b, xlab='Population', ylab='residuals')
abline(h=0, col='red')
qqnorm(R2b)
qqline(R2b, col='green')
R2c = fit3$residuals
plot(X1, y = R2c, xlab='Population', ylab='residuals')
abline(h=0, col='red')
qqnorm(R2c)
qqline(R2c, col='green')
knitr::opts_chunk$set(echo = TRUE)
knitr::include_graphics("20210501_000812.jpg")
GPAdata = read.table("grade+point+average.txt")
colnames(GPAdata) <- c("y", "x", "x2", "x3")
X1 = GPAdata[,2]
numvalsx = length(X1)
boxplot(X1, horizontal = TRUE, xlab = "Scores")
title("Boxplot of ACT Scores")
Y1 = GPAdata[,1]
numVals = length(Y1)
fit1 = lm(Y1~X1)
bohat1 = fit1$coefficients[[1]]
b1hat1 = fit1$coefficients[[2]]
Yi_hat1 = bohat1 + b1hat1 * (X1)
Y1_1 = Y1-Yi_hat1
fit1 = lm(Y1_1~X1)
plot(X1,Y1_1,
xlim = c(15,35), ylim=c(-3,2),
main = " Scores vs Residuals(Y-Yihat)",
xlab = "Score",
ylab = "GPA Residual",
cex.main = .85)
abline(fit1, col = "green")
e1 = fit1$residuals
fit1_1 = lm(e1~Yi_hat1)
plot(Yi_hat1,e1,
main = " e1 vs Y;",
xlab = "Y",
ylab = "e1",
cex.main = .85)
abline(fit1_1, col = "green")
res = qqnorm(e1)
qqline(e1, col='green')
r=cor(res$x, res$y)#res$x is expected residuals, res$y is observed residuals
cat("r = ", r)
group1 <- GPAdata$x < 26
group2 <- !group1
d1 <- abs(e1[group1] - median(e1[group1]))
d2 <- abs(e1[group2] - median(e1[group2]))
n <- length(e1)
n1 <- length(d1)
n2 <- length(d2)
s <- sqrt((sum((d1-mean(d1))^2)+sum((d2-mean(d2))^2))/(n - 2))
tstar <- (mean(d1)-mean(d2))/s/sqrt(1/n1+1/n2)
tcrit <- qt(0.995, df = n-2)
abs(tstar) <= tcrit
plot(GPAdata[,3], e1, xlab = "x2", ylab = "residuals", main = "residuals vs X2")
plot(GPAdata[,4], e1, xlab = "x2", ylab = "residuals", main = "residuals vs X3")
PCEdata <- read.table("per+capita+earnings.txt")
yhat2 = PCEdata[,1]
e2 = PCEdata[,2]
fit2 = lm(e2~yhat2)
plot(yhat2,e2,
main = " Residuals vs Yhat",
xlab = "Yhat",
ylab = "Residuals")
# Given our sd = 1
sum(e2 > 1 | e2 < -1)
Soldata <- read.table("solution+concentration.txt")
X4 = Soldata[,2]
Y4 = Soldata[,1]
b1hat4 = t(X4-mean(X4))%*%(Y4-mean(Y4))/sum((X4-mean(X4))^2)
b0hat4 = mean(Y4) - b1hat4*mean(X4)
cat("Y = ", b0hat4, " + ", b1hat4, "x\n")
knitr::include_graphics("20210430_235736.jpg")
knitr::opts_chunk$set(echo = TRUE)
# Getting the data
CDI = read.table("CDI.txt")
knitr::opts_chunk$set(echo = TRUE)
# Getting the data
#CDI = read.table("CDI.txt")
X1 = CDI[,5] #Population in Hundred Thousands
X1 = c(1, 0, 2, 0, 3, 1, 0, 1, 2, 0)
Y = c(16, 9, 17, 12, 22, 13, 8, 15, 19, 11)
n = length(X1)
# hw 3
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSTO1 = sum((Y1-mean(Y1))^2)
SSE1 = sum((Y1-y_hat1)^2)
SSR1 = sum((y_hat1-mean(Y1))^2)
MSR1 = SSR1/(1)
MSE1 = SSE1/(n1-2)
Fstatistic1 = MSR1/MSE1
Fstatistic1
r1 = cor(X1,Y1)
knitr::opts_chunk$set(echo = TRUE)
# Getting the data
#CDI = read.table("CDI.txt")
X1 = CDI[,5] #Population in Hundred Thousands
X1 = c(1, 0, 2, 0, 3, 1, 0, 1, 2, 0)
Y = c(16, 9, 17, 12, 22, 13, 8, 15, 19, 11)
n = length(X1)
# hw 3
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSTO1 = sum((Y1-mean(Y1))^2)
SSE1 = sum((Y1-y_hat1)^2)
SSR1 = sum((y_hat1-mean(Y1))^2)
MSR1 = SSR1/(1)
MSE1 = SSE1/(n1-2)
Fstatistic1 = MSR1/MSE1
Fstatistic1
r1 = cor(X1,Y)
t1 = r1*sqrt(n1-2)/sqrt(1-r1^2)
t1
F1 = t1 ^ 2
F1
pvalue1 = pf(Fstatistic1, 1, n1-2, lower.tail = F)
b1hat1 = t(X1-mean(X1))%*%(Y-mean(Y))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y) - b1hat1*mean(X1)
plot(X1, Y, xlab="Population", ylab="Number of Active Physicians" , main = "Population vs\nNumber of Physicians")
abline(lm(Y ~ X1))
fit.y1 = b0hat1[1] + b1hat1[1]*X1
mse1 = 1/(n-2)*sum((Y - fit.y1)^2)
R1b1hat1 = t(RX1-mean(RX1))%*%(RY1-mean(RY1))/sum((RX1-mean(RX1))^2)
R1b0hat1 = mean(RY1) - R1b1hat1*mean(RX1)
R1fit = R1b0hat1[1] + R1b1hat1[1]*RX1
R1mse = 1/(R1n-2)*sum((RY1 - R1fit)^2)
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSR = sum((y_hat1 - mean(Y))^2)
SSTO = sum (((Y - mean(Y)))^2)
library (knitr)
confint(fitr4, parm = "RX4",  level = 0.90)
kable(anova(fitr1))
R2a = fit1$residuals
plot(X1, y = R2a, xlab='Population', ylab='residuals')
abline(h=0, col='red')
qqnorm(R2a)
qqline(R2a, col='green')
boxplot(X1, horizontal = TRUE, xlab = "Scores")
title("Boxplot of ACT Scores")
Y1 = GPAdata[,1]
numVals = length(Y1)
fit1 = lm(Y1~X1)
knitr::opts_chunk$set(echo = TRUE)
# Getting the data
#CDI = read.table("CDI.txt")
X1 = CDI[,5] #Population in Hundred Thousands
X1 = c(1, 0, 2, 0, 3, 1, 0, 1, 2, 0)
Y = c(16, 9, 17, 12, 22, 13, 8, 15, 19, 11)
n = length(X1)
# hw 3
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSTO1 = sum((Y1-mean(Y1))^2)
SSE1 = sum((Y1-y_hat1)^2)
SSR1 = sum((y_hat1-mean(Y1))^2)
MSR1 = SSR1/(1)
MSE1 = SSE1/(n1-2)
Fstatistic1 = MSR1/MSE1
Fstatistic1
r1 = cor(X1,Y)
t1 = r1*sqrt(n1-2)/sqrt(1-r1^2)
t1
F1 = t1 ^ 2
F1
pvalue1 = pf(Fstatistic1, 1, n1-2, lower.tail = F)
b1hat1 = t(X1-mean(X1))%*%(Y-mean(Y))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y) - b1hat1*mean(X1)
plot(X1, Y, xlab="Population", ylab="Number of Active Physicians" , main = "Population vs\nNumber of Physicians")
abline(lm(Y ~ X1))
fit.y1 = b0hat1[1] + b1hat1[1]*X1
mse1 = 1/(n-2)*sum((Y - fit.y1)^2)
R1b1hat1 = t(RX1-mean(RX1))%*%(RY1-mean(RY1))/sum((RX1-mean(RX1))^2)
R1b0hat1 = mean(RY1) - R1b1hat1*mean(RX1)
R1fit = R1b0hat1[1] + R1b1hat1[1]*RX1
R1mse = 1/(R1n-2)*sum((RY1 - R1fit)^2)
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSR = sum((y_hat1 - mean(Y))^2)
SSTO = sum (((Y - mean(Y)))^2)
library (knitr)
confint(fitr4, parm = "RX4",  level = 0.90)
kable(anova(fitr1))
R2a = fit1$residuals
plot(X1, y = R2a, xlab='Population', ylab='residuals')
abline(h=0, col='red')
qqnorm(R2a)
qqline(R2a, col='green')
boxplot(X1, horizontal = TRUE, xlab = "Scores")
title("Boxplot of ACT Scores")
Y1 = GPAdata[,1]
numVals = length(Y1)
fit1 = lm(Y~X1)
bohat1 = fit1$coefficients[[1]]
b1hat1 = fit1$coefficients[[2]]
Yi_hat1 = bohat1 + b1hat1 * (X1)
Y1_1 = Y1-Yi_hat1
fit1 = lm(Y1_1~X1)
knitr::opts_chunk$set(echo = TRUE)
# Getting the data
#CDI = read.table("CDI.txt")
X1 = CDI[,5] #Population in Hundred Thousands
X1 = c(1, 0, 2, 0, 3, 1, 0, 1, 2, 0)
Y = c(16, 9, 17, 12, 22, 13, 8, 15, 19, 11)
n = length(X1)
# hw 3
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSTO1 = sum((Y1-mean(Y1))^2)
SSE1 = sum((Y1-y_hat1)^2)
SSR1 = sum((y_hat1-mean(Y1))^2)
MSR1 = SSR1/(1)
MSE1 = SSE1/(n1-2)
Fstatistic1 = MSR1/MSE1
Fstatistic1
r1 = cor(X1,Y)
t1 = r1*sqrt(n1-2)/sqrt(1-r1^2)
t1
F1 = t1 ^ 2
F1
pvalue1 = pf(Fstatistic1, 1, n1-2, lower.tail = F)
b1hat1 = t(X1-mean(X1))%*%(Y-mean(Y))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y) - b1hat1*mean(X1)
plot(X1, Y, xlab="Population", ylab="Number of Active Physicians" , main = "Population vs\nNumber of Physicians")
abline(lm(Y ~ X1))
fit.y1 = b0hat1[1] + b1hat1[1]*X1
mse1 = 1/(n-2)*sum((Y - fit.y1)^2)
R1b1hat1 = t(RX1-mean(RX1))%*%(RY1-mean(RY1))/sum((RX1-mean(RX1))^2)
R1b0hat1 = mean(RY1) - R1b1hat1*mean(RX1)
R1fit = R1b0hat1[1] + R1b1hat1[1]*RX1
R1mse = 1/(R1n-2)*sum((RY1 - R1fit)^2)
fit1 = lm(Y~X1)
y_hat1 = fit1$fitted.values
SSR = sum((y_hat1 - mean(Y))^2)
SSTO = sum (((Y - mean(Y)))^2)
library (knitr)
confint(fitr4, parm = "RX4",  level = 0.90)
kable(anova(fitr1))
R2a = fit1$residuals
plot(X1, y = R2a, xlab='Population', ylab='residuals')
abline(h=0, col='red')
qqnorm(R2a)
qqline(R2a, col='green')
boxplot(X1, horizontal = TRUE, xlab = "Scores")
title("Boxplot of ACT Scores")
numVals = length(Y1)
fit1 = lm(Y~X1)
bohat1 = fit1$coefficients[[1]]
b1hat1 = fit1$coefficients[[2]]
Yi_hat1 = bohat1 + b1hat1 * (X1)
Y1_1 = Y1-Yi_hat1
fit1 = lm(Y1_1~X1)
knitr::opts_chunk$set(echo = TRUE)
X1 = c(15,17,18,15,16,19,17,16,18,19)
Y1 = c(2289, 3393, 3271, 2648, 2897, 3327, 2970, 2535, 3138, 3573)
fit1 = lm(Y1~X1)
plot(X1, Y1, xlab="Maternal Age", ylab="Birth Weight (g)" , main = "Maternal Age vs. Birth Weight")
abline(fit1, col = "orange")
b1hat1 = t(X1-mean(X1))%*%(Y1-mean(Y1))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y1) - b1hat1*mean(X1)
E17 = b0hat1 + (b1hat1 * 17)
E16 = b0hat1 + (b1hat1 * 16)
E17 - E16
b1hat1 = t(X1-mean(X1))%*%(Y1-mean(Y1))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y1) - b1hat1*mean(X1)
E17 = b0hat1 + (b1hat1 * 17)
E16 = b0hat1 + (b1hat1 * 16)
cat(E17, " - ", E16 " :")
b1hat1 = t(X1-mean(X1))%*%(Y1-mean(Y1))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y1) - b1hat1*mean(X1)
E17 = b0hat1 + (b1hat1 * 17)
E16 = b0hat1 + (b1hat1 * 16)
cat(E17, " - ", E16, " :")
E17 - E16
b1hat1 = t(X1-mean(X1))%*%(Y1-mean(Y1))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y1) - b1hat1*mean(X1)
E17 = b0hat1 + (b1hat1 * 17)
E16 = b0hat1 + (b1hat1 * 16)
cat(E17, " - ", E16, " :", E17 - E16)
plot(X2, Y2, xlab="Days", ylab="Dry Weight (g)" , main = "Days vs. Dry Weight")
X2 = c(31, 31, 31, 31, 31, 34, 34, 34, 34, 34)
Y2 = c(8.31, 7.67, 6.09, 7.01, 6.96, 9.13, 12.51, 12.30, 10.80, 9.04)
plot(X2, Y2, xlab="Days", ylab="Dry Weight (g)" , main = "Days vs. Dry Weight")
plot(X2, Y2, xlab="Days", ylab="Dry Weight (g)" , main = "Days vs. Dry Weight")
abline(lm(Y1~X1), col = "green")
fit2 = lm(Y2~X2)
e2 = fit2$residuals
group2_1 <- X2 < 26
group2_2 <- !group2_1
d2_1 <- abs(e1[group2_1] - median(e1[group2_1]))
d2_2 <- abs(e1[group2_2] - median(e1[group2_2]))
n2 <- length(e1)
n2_1 <- length(d2_1)
n2_2 <- length(d2_2)
s2 <- sqrt((sum((d2_1-mean(d2_1))^2)+sum((d2_2-mean(d2_2))^2))/(n2 - 2))
tstar <- (mean(d2_1)-mean(d2_2))/s2/sqrt(1/n2_1+1/n2_2)
tcrit <- qt(0.995, df = n-2)
abs(tstar) <= tcrit
fit2 = lm(Y2~X2)
e2 = fit2$residuals
group2_1 <- X2 < 26
group2_2 <- !group2_1
d2_1 <- abs(e1[group2_1] - median(e1[group2_1]))
d2_2 <- abs(e1[group2_2] - median(e1[group2_2]))
n2 <- length(e1)
n2_1 <- length(d2_1)
n2_2 <- length(d2_2)
s2 <- sqrt((sum((d2_1-mean(d2_1))^2)+sum((d2_2-mean(d2_2))^2))/(n2 - 2))
tstar <- (mean(d2_1)-mean(d2_2))/s2/sqrt(1/n2_1+1/n2_2)
tstar
tcrit <- qt(0.995, df = n-2)
abs(tstar) <= tcrit
fit2 = lm(Y2~X2)
e2 = fit2$residuals
group2_1 <- X2 = 31
fit2 = lm(Y2~X2)
e2 = fit2$residuals
group2_1 <- X2 == 31
group2_2 <- !group2_1
d2_1 <- abs(e1[group2_1] - median(e1[group2_1]))
d2_2 <- abs(e1[group2_2] - median(e1[group2_2]))
n2 <- length(e1)
n2_1 <- length(d2_1)
n2_2 <- length(d2_2)
s2 <- sqrt((sum((d2_1-mean(d2_1))^2)+sum((d2_2-mean(d2_2))^2))/(n2 - 2))
tstar <- (mean(d2_1)-mean(d2_2))/s2/sqrt(1/n2_1+1/n2_2)
tstar
tcrit <- qt(0.995, df = n-2)
abs(tstar) <= tcrit
tcrit <- qt((1 - (0.05/2)), df = n-2)
abs(tstar) <= tcrit
plot(X2, Y2, xlab="Days", ylab="Dry Weight (g)" , main = "Days vs. Dry Weight")
abline(fit2)
plot(X2, Y2, xlab="Days", ylab="Dry Weight (g)" , main = "Days vs. Dry Weight")
abline(fit2, col = "blue")
y_hat1 = fit1$fitted.values
MSE1 = (sum((Y1-y_hat1)^2))/(n1-2)
se16 = sqrt(MSE * ((1/n1)+(((16 - mean(X1)) ^ 2)/((sum(X1 - mean(X1)))^2))))
y_hat1 = fit1$fitted.values
MSE1 = (sum((Y1-y_hat1)^2))/(n1-2)
se16 = sqrt(MSE1 * ((1/n1)+(((16 - mean(X1)) ^ 2)/((sum(X1 - mean(X1)))^2))))
se16
y_hat1 = fit1$fitted.values
MSE1 = (sum((Y1-y_hat1)^2))/(n1-2)
MSE1
confint(fitr1, parm = "Interval: ",  level = 0.95)
confint(fit1, parm = "Interval: ",  level = 0.95)
confint(lm(Y1~X1), parm = "Interval: ",  level = 0.95)
knitr::opts_chunk$set(echo = TRUE)
X1 = c(15,17,18,15,16,19,17,16,18,19)
Y1 = c(2289, 3393, 3271, 2648, 2897, 3327, 2970, 2535, 3138, 3573)
n1 = length(X1)
fit1 = lm(Y1~X1)
plot(X1, Y1, xlab="Maternal Age", ylab="Birth Weight (g)" , main = "Maternal Age vs. Birth Weight")
abline(fit1, col = "orange")
b1hat1 = t(X1-mean(X1))%*%(Y1-mean(Y1))/sum((X1-mean(X1))^2)
b0hat1 = mean(Y1) - b1hat1*mean(X1)
E17 = b0hat1 + (b1hat1 * 17)
cat("E17: ", E17)
E16 = b0hat1 + (b1hat1 * 16)
cat("E16: ", E16)
cat(E17, " - ", E16, " :", E17 - E16)
y_hat1 = fit1$fitted.values
MSE1 = (sum((Y1-y_hat1)^2))/(n1-2)
MSE1
SSTO1 = sum((Y1-mean(Y1))^2)
SSTO1
confint(lm(Y1~X1), parm = "Interval: ",  level = 0.95)
X2 = c(31, 31, 31, 31, 31, 34, 34, 34, 34, 34)
Y2 = c(8.31, 7.67, 6.09, 7.01, 6.96, 9.13, 12.51, 12.30, 10.80, 9.04)
plot(X2, Y2, xlab="Days", ylab="Dry Weight (g)" , main = "Days vs. Dry Weight")
#1.
fit2 = lm(Y2~X2)
e2 = fit2$residuals
#2.
group2_1 <- X2 == 31
group2_2 <- !group2_1
#3.
d2_1 <- abs(e2[group2_1] - median(e2[group2_1]))
d2_2 <- abs(e2[group2_2] - median(e2[group2_2]))
#4.
n2 <- length(e2)
n2_1 <- length(d2_1)
n2_2 <- length(d2_2)
#5.
s2 <- sqrt((sum((d2_1-mean(d2_1))^2)+sum((d2_2-mean(d2_2))^2))/(n2 - 2))
tstar <- (mean(d2_1)-mean(d2_2))/s2/sqrt(1/n2_1+1/n2_2)
cat("Statistic: ", tstar)
tcrit <- qt((1 - (0.05/2)), df = n2-2)
cat("Critical Value: ", tcrit)
cat("Result: ", abs(tstar) <= tcrit)
plot(X2, Y2, xlab="Days", ylab="Dry Weight (g)" , main = "Days vs. Dry Weight")
abline(fit2, col = "blue")
