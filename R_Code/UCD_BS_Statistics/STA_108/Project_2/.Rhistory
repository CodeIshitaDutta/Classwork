qfit = lm(Y~X + X_2)
qline = qfit$coefficient[3]*X^2 + qfit$coefficient[2]*X + qfit$coefficient[1]
plot(X, Y, xlab="X", ylab="Y", pch=19, col = "blue")
points(X, qfit, xlab="X", ylab="Y", pch=19, col = "red")
steroids = read.table("steriod+level.txt")
Y = steroids[,2]
X = steroids[,1]
X_2 = X ^ 2
qfit = lm(Y~X + X_2)
qline = qfit$coefficient[3]*X^2 + qfit$coefficient[2]*X + qfit$coefficient[1]
plot(X, Y, xlab="X", ylab="Y", pch=19, col = "blue")
points(X, qfit$fitted.values, xlab="X", ylab="Y", pch=19, col = "red")
steroids = read.table("steriod+level.txt")
Y = steroids[,2]
X = steroids[,1]
X_2 = X ^ 2
qfit = lm(Y~X + X_2)
qline = qfit$coefficient[3]*X^2 + qfit$coefficient[2]*X + qfit$coefficient[1]
plot(X, Y, xlab="X", ylab="Y", pch=19, col = "blue")
points(X, qfit$fitted.values, xlab="X", ylab="Y", pch=19, col = "red")
points(X, qline, xlab="X", ylab="Y", pch=19, col = "orange")
summary(qfit)$r.squared
anova(qfit)
mse = summary(fit)$sigma^2
knitr::opts_chunk$set(echo = TRUE)
brands = read.table("brand+preference.txt")
Y = brands[,1]
X1 = brands[,2]
X2 = brands[,3]
fit = lm(Y~X1+X2)
anova(fit)
mse = summary(fit)$sigma^2
mse
b0 = fit$coefficients[1]
b1 = fit$coefficients[2]
b2 = fit$coefficients[3]
se.yhat_x1 = sqrt(mse/sum((X1 - mean(X1))^2))
se.yhat_x2 = sqrt(mse/sum((X2 - mean(X2))^2))
B <-1- qt(.99/(2 * 2), length(X1) - 3)
bh.lowerx1 <- b1 - B * se.yhat_x1
bh.upperx1 <- b1 + B * se.yhat_x1
bh.lowerx2 <- b2 - B * se.yhat_x2
bh.upperx2 <- b2 + B * se.yhat_x2
cat("X1 Interval: [", bh.lowerx1,",",bh.upperx1,"]\n")
cat("X2 Interval: [", bh.lowerx2,",",bh.upperx2,"]\n")
ansmat = matrix(c(1,1,2,3),ncol=1)
colnames(ansmat) <- c("Degrees of Freedom")
rownames(ansmat) <- c("SSR(X1|X2)","SSR(X2|X1, X3)","SSR(X1, X2|X3, X4)", "SSR(X1, X2, X3|X4, X5)")
ansmat = as.table(ansmat)
ansmat
fit = lm(Y~X1+X2)
SSTO = sum(anova(fit)[,2])
SSRX1 =anova(fit)[1,2]
SSRX2.X1 =anova(fit)[2,2]
anova(fit)
MSE = anova(fit)[3,3]
Fstar = ((SSRX2.X1)/1)/MSE
qf(.99,1,13)
Pval = pf(Fstar,1,13,lower.tail=F)
patients = read.table("patient+satisfaction.txt")
Y1 = patients[,1]
X11 = patients[,2]
X12 = patients[,3]
X13 = patients[,4]
n=length(Y1)
ModelX11 = lm(Y1~X11)
FModel =lm(Y1~X11+X12+X13)
SSE.X11 = anova(ModelX11)[2,2]
SSE.X11X12X13 = anova(FModel)[4,2]
SSR.X12X13.X11 = SSE.X11- SSE.X11X12X13
MSE = anova(FModel)[4,3]
Fstar = (SSR.X12X13.X11/2)/MSE
qf(.975,2,n-4)
Pval = pf(Fstar,2,n-4,lower.tail=F)
mse = summary(fit)$sigma^2
mse
anova(fit)['Residuals', 'Mean Sq']
b0 = fit$coefficients[1]
b1 = fit$coefficients[2]
b2 = fit$coefficients[3]
se.yhat_x1 = sqrt(mse/sum((X1 - mean(X1))^2))
se.yhat_x2 = sqrt(mse/sum((X2 - mean(X2))^2))
B <-1- qt(.99/(2 * 2), length(X1) - 3)
bh.lowerx1 <- b1 - B * se.yhat_x1
bh.upperx1 <- b1 + B * se.yhat_x1
bh.lowerx2 <- b2 - B * se.yhat_x2
bh.upperx2 <- b2 + B * se.yhat_x2
cat("X1 Interval: [", bh.lowerx1,",",bh.upperx1,"]\n")
cat("X2 Interval: [", bh.lowerx2,",",bh.upperx2,"]\n")
mse = summary(fit)$sigma^2
mse
anova(fit)['Residuals', 'Mean Sq']
mean(fit$residuals^2)
b0 = fit$coefficients[1]
b1 = fit$coefficients[2]
b2 = fit$coefficients[3]
se.yhat_x1 = sqrt(mse/sum((X1 - mean(X1))^2))
se.yhat_x2 = sqrt(mse/sum((X2 - mean(X2))^2))
B <-1- qt(.99/(2 * 2), length(X1) - 3)
bh.lowerx1 <- b1 - B * se.yhat_x1
bh.upperx1 <- b1 + B * se.yhat_x1
bh.lowerx2 <- b2 - B * se.yhat_x2
bh.upperx2 <- b2 + B * se.yhat_x2
cat("X1 Interval: [", bh.lowerx1,",",bh.upperx1,"]\n")
cat("X2 Interval: [", bh.lowerx2,",",bh.upperx2,"]\n")
mse = summary(fit)$sigma^2
mse
anova(fit)['Residuals', 'Mean Sq']
mean(summary(fit)$residuals^2)
b0 = fit$coefficients[1]
b1 = fit$coefficients[2]
b2 = fit$coefficients[3]
se.yhat_x1 = sqrt(mse/sum((X1 - mean(X1))^2))
se.yhat_x2 = sqrt(mse/sum((X2 - mean(X2))^2))
B <-1- qt(.99/(2 * 2), length(X1) - 3)
bh.lowerx1 <- b1 - B * se.yhat_x1
bh.upperx1 <- b1 + B * se.yhat_x1
bh.lowerx2 <- b2 - B * se.yhat_x2
bh.upperx2 <- b2 + B * se.yhat_x2
cat("X1 Interval: [", bh.lowerx1,",",bh.upperx1,"]\n")
cat("X2 Interval: [", bh.lowerx2,",",bh.upperx2,"]\n")
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
knitr::opts_chunk$set(echo = TRUE)
steroids = read.table("steriod+level.txt")
Y = steroids[,2]
X = steroids[,1]
X_2 = X ^ 2
qfit = lm(Y~X + X_2)
qfitvals = qfit$fitted.values
plot(X, Y, xlab="X", ylab="Y", pch=19, col = "blue")
points(X, qfitvals, xlab="X", ylab="Y", pch=19, col = "orange")
summary(qfit)$r.squared
anova(qfit)
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
se.yhat_x1 = sqrt(mse/sum((X - mean(X))^2))
se.yhat_x2 = sqrt(mse/sum((X_2 - mean(X_2))^2))
B <-1- qt(.99/(2 * 2), length(X) - 3)
bh.lowerx1 <- b1 - B * se.yhat_x1
bh.upperx1 <- b1 + B * se.yhat_x1
bh.lowerx2 <- b2 - B * se.yhat_x2
bh.upperx2 <- b2 + B * se.yhat_x2
cat("X1 Interval: [", bh.lowerx1,",",bh.upperx1,"]\n")
cat("X2 Interval: [", bh.lowerx2,",",bh.upperx2,"]\n")
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
y_10 = qfit$fitted.values(10)
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
qfit$fitted.values
y_10 = b0 + b1 * 10 + b2 * 10
y_15 = b0 + b1 * 10
y_20
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
qfit$fitted.values[10]
y_10 = b0 + b1 * 10 + b2 * 10
y_15 = b0 + b1 * 10
y_20
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
qfit$fitted.values[10]
y_10 = qfit$fitted.values[10]
y_10
y_15 = qfit$fitted.values[15]
y_15
y_20 = qfit$fitted.values[20]
y_20
pse.yhat_x1 = sqrt(mse/sum((X - mean(X))^2))
pse.yhat_x2 = sqrt(mse/sum((X_2 - mean(X_2))^2))
B <-1- qt(.99/(2 * 2), length(X) - 3)
bh.lowerx1 <- b1 - B * pse.yhat_x1
bh.upperx1 <- b1 + B * pse.yhat_x1
bh.lowerx2 <- b2 - B * pse.yhat_x2
bh.upperx2 <- b2 + B * pse.yhat_x2
cat("X1 Interval: [", bh.lowerx1,",",bh.upperx1,"]\n")
cat("X2 Interval: [", bh.lowerx2,",",bh.upperx2,"]\n")
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
y_10 = qfit$fitted.values[10]
y_15 = qfit$fitted.values[15]
y_20 = qfit$fitted.values[20]
pse.yhat = sqrt(mse/sum(((X + X_2) - mean(X + X_2))^2))
B <-1- qt(.99/(2 * 2), length(X) - 3)
bh.lower10 <- y_10 - B * pse.yhat
bh.upper10 <- y_10 + B * pse.yhat
cat("X1 Interval: [", bh.lower10,",",bh.upper10,"]\n")
#cat("X2 Interval: [", bh.lower15,",",bh.upper15,"]\n")
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
y_10 = qfit$fitted.values[10]
y_15 = qfit$fitted.values[15]
y_20 = qfit$fitted.values[20]
pse.yhat = sqrt(mse/sum(((X + X_2) - mean(X + X_2))^2))
B <-1- qt(.99/(2 * 2), length(X) - 3)
bh.lower10 <- y_10 - B * pse.yhat
bh.upper10 <- y_10 + B * pse.yhat
bh.lower15 <- y_15 - B * pse.yhat
bh.upper15 <- y_15 + B * pse.yhat
bh.lower20 <- y_20 - B * pse.yhat
bh.upper20 <- y_20 + B * pse.yhat
cat("10 Interval: [", bh.lower10,",",bh.upper10,"]\n")
cat("15 Interval: [", bh.lower15,",",bh.upper15,"]\n")
cat("20 Interval: [", bh.lower20,",",bh.upper20,"]\n")
mse = anova(fit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
y_10 = qfit$fitted.values[10]
y_15 = qfit$fitted.values[15]
y_20 = qfit$fitted.values[20]
pse.yhat = sqrt(mse/sum(((X + X_2) - mean(X + X_2))^2))
B <-1- qt(.99/(2 * 2), length(X) - 3)
bh.lower10 <- y_10 - B * pse.yhat
bh.upper10 <- y_10 + B * pse.yhat
bh.lower15 <- y_15 - B * pse.yhat
bh.upper15 <- y_15 + B * pse.yhat
bh.lower20 <- y_20 - B * pse.yhat
bh.upper20 <- y_20 + B * pse.yhat
cat("10 Interval: [", bh.lower10,",",bh.upper10,"]\n")
cat("15 Interval: [", bh.lower15,",",bh.upper15,"]\n")
cat("20 Interval: [", bh.lower20,",",bh.upper20,"]\n")
n=length(Y)
kable(anova(qfit))
cat("F* --> ",n, "\n")
cat("F(0.99, 1, n-4) --> ",qf(0.99, 1,n - 4), "\n")
n=length(Y)
kable(anova(qfit))
cat("F* --> ",anova(qfit)[3,4], "\n")
cat("F(0.99, 1, n-4) --> ",qf(0.99, 1,n - 4), "\n")
n=length(Y)
kable(anova(qfit))
cat("F* --> ",anova(qfit)[3,2], "\n")
cat("F(0.99, 1, n-4) --> ",qf(0.99, 1,n - 4), "\n")
n=length(Y)
kable(anova(qfit))
cat("F* --> ",anova(qfit)[2,4], "\n")
cat("F(0.99, 1, n-4) --> ",qf(0.99, 1,n - 4), "\n")
n=length(Y)
anova(qfit)
cat("F* --> ",anova(qfit)[2,4], "\n")
cat("F(0.99, 1, n-4) --> ",qf(0.99, 1,n - 4), "\n")
copier = read.table("copier+maintenance.txt")
X2 = read.table("X2.txt")[1]
copier = read.table("copier+maintenance.txt")
Y = copier[,2]
X1 = copier[,1]
X2 = read.table("X2.txt")[1]
knitr::opts_chunk$set(echo = TRUE)
steroids = read.table("steriod+level.txt")
Y = steroids[,2]
X = steroids[,1]
X_2 = X ^ 2
qfit = lm(Y~X + X_2)
qfitvals = qfit$fitted.values
plot(X, Y, xlab="X", ylab="Y", pch=19, col = "blue")
points(X, qfitvals, xlab="X", ylab="Y", pch=19, col = "orange")
summary(qfit)$r.squared
anova(qfit)
mse = anova(qfit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
y_10 = qfit$fitted.values[10]
y_15 = qfit$fitted.values[15]
y_20 = qfit$fitted.values[20]
pse.yhat = sqrt(mse/sum(((X + X_2) - mean(X + X_2))^2))
B <-1- qt(.99/(2 * 2), length(X) - 3)
bh.lower10 <- y_10 - B * pse.yhat
bh.upper10 <- y_10 + B * pse.yhat
bh.lower15 <- y_15 - B * pse.yhat
bh.upper15 <- y_15 + B * pse.yhat
bh.lower20 <- y_20 - B * pse.yhat
bh.upper20 <- y_20 + B * pse.yhat
cat("10 Interval: [", bh.lower10,",",bh.upper10,"]\n")
cat("15 Interval: [", bh.lower15,",",bh.upper15,"]\n")
cat("20 Interval: [", bh.lower20,",",bh.upper20,"]\n")
n=length(Y)
anova(qfit)
cat("F* --> ",anova(qfit)[2,4], "\n")
cat("F(0.99, 1, n-4) --> ",qf(0.99, 1,n - 4), "\n")
copier = read.table("copier+maintenance.txt")
Y = copier[,2]
X1 = copier[,1]
X2 = read.table("X2.txt")[1]
copier = read.table("copier+maintenance.txt")
Y2 = copier[,2]
X1 = copier[,1]
X2 = read.table("X2.txt")[1]
knitr::opts_chunk$set(echo = TRUE)
steroids = read.table("steriod+level.txt")
Y = steroids[,2]
X = steroids[,1]
X_2 = X ^ 2
qfit = lm(Y~X + X_2)
qfitvals = qfit$fitted.values
plot(X, Y, xlab="X", ylab="Y", pch=19, col = "blue")
points(X, qfitvals, xlab="X", ylab="Y", pch=19, col = "orange")
summary(qfit)$r.squared
anova(qfit)
mse = anova(qfit)['Residuals', 'Mean Sq']
b0 = qfit$coefficients[1]
b1 = qfit$coefficients[2]
b2 = qfit$coefficients[3]
y_10 = qfit$fitted.values[10]
y_15 = qfit$fitted.values[15]
y_20 = qfit$fitted.values[20]
pse.yhat = sqrt(mse/sum(((X + X_2) - mean(X + X_2))^2))
B <-1- qt(.99/(2 * 2), length(X) - 3)
bh.lower10 <- y_10 - B * pse.yhat
bh.upper10 <- y_10 + B * pse.yhat
bh.lower15 <- y_15 - B * pse.yhat
bh.upper15 <- y_15 + B * pse.yhat
bh.lower20 <- y_20 - B * pse.yhat
bh.upper20 <- y_20 + B * pse.yhat
cat("10 Interval: [", bh.lower10,",",bh.upper10,"]\n")
cat("15 Interval: [", bh.lower15,",",bh.upper15,"]\n")
cat("20 Interval: [", bh.lower20,",",bh.upper20,"]\n")
n=length(Y)
anova(qfit)
cat("F* --> ",anova(qfit)[2,4], "\n")
cat("F(0.99, 1, n-4) --> ",qf(0.99, 1,n - 4), "\n")
copier = read.table("copier+maintenance.txt")
Y2 = copier[,2]
X1 = copier[,1]
X2 = read.table("X2.txt")[1]
fit2= lm(Y2 ~ X1 + X2)
fit2 = lm(Y2 ~ X1 + X2)
copier = read.table("copier+maintenance.txt")
Y2 = copier[,2]
X1 = copier[,1]
copierx2 = read.table("X2.txt")
X2 = copier[,1]
fit2 = lm(Y2 ~ X1 + X2)
summary(fit2)
copier = read.table("copier+maintenance.txt")
Y2 = copier[,2]
X1 = copier[,1]
X2 = read.table("X2.txt")[,1]
fit2 = lm(Y2 ~ X1 + X2)
summary(fit2)
x1.1 = subset(copier, X2 == 1)
x1.1
fit2 = lm(Y2 ~ X1 + X2)
summary(fit2)
copier.1 = subset(copier, X2 == 1)
fit.1 = lm(copier.1[,2] ~ copier.1[,1] + 1)
summary(fit.1)
copier.0 = subset(copier, X2 == 1)
fit.0 = lm(copier.0[,2] ~ copier.0[,1] + 1)
summary(fit.0)
fit2 = lm(Y2~X1 + X2)
summary(fit.2)
fit2 = lm(Y2~X1 + X2)
summary(fit2)
copier.1 = subset(copier, X2 == 1)
fit.1 = lm(copier.1[,2] ~ copier.1[,1] + 1)
summary(fit.1)
copier.0 = subset(copier, X2 == 1)
fit.0 = lm(copier.0[,2] ~ copier.0[,1] + 1)
summary(fit.0)
copier = read.table("copier+maintenance.txt")
Y2 = copier[,1]
X1 = copier[,2]
X2 = read.table("X2.txt")[,1]
fit2 = lm(Y2~X1 + X2)
summary(fit2)
copier.1 = subset(copier, X2 == 1)
fit.1 = lm(copier.1[,2] ~ copier.1[,1] + 1)
summary(fit.1)
copier.0 = subset(copier, X2 == 1)
fit.0 = lm(copier.0[,2] ~ copier.0[,1] + 1)
summary(fit.0)
fit2 = lm(Y2~X1 + X2)
summary(fit2)
confint(fit2, level = .95)
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
m1 = fit2$residuals
m2 = fit2.2$residuals
pr1 = m1/(1 - lm.influence(fit2),hat)
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
m1 = fit2$residuals
m2 = fit2.2$residuals
pr1 = m1/(1 - lm.influence(fit2)$hat)
pr2= m2/(1−lm.influence(fit2.2)$hat)
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
m1 = fit2$residuals
m2 = fit2.2$residuals
pr1 = m1/(1 - lm.influence(fit2)$hat)
pr1
pr2= m2/(1−lm.influence(fit2.2)$hat)
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
m1 = fit2$residuals
m2 = fit2.2$residuals
pr1 = m1/(1 - lm.influence(fit2)$hat)
pr2= m2/(1-lm.influence(fit2.2)$hat)
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
m1 = fit2$residuals
m2 = fit2.2$residuals
pr1 = m1/(1 - lm.influence(fit2)$hat)
pr2= m2/(1-lm.influence(fit2.2)$hat)
sum(pr12)
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
m1 = fit2$residuals
m2 = fit2.2$residuals
pr1 = m1/(1 - lm.influence(fit2)$hat)
pr2= m2/(1-lm.influence(fit2.2)$hat)
sum(pr1^2)
sum(pr2^2)
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
m1 = fit2$r.squared
m2 = fit2.2$r.squared
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
fit2$r.squared
fit2.2$r.squared
fit2.2 = lm( Y2 ~ X2)
summary(fit2.2)
summary(fit2)$r.squared
summary(fit2.2)$r.squared
fit2.2 = lm( Y2 ~ X2)
summary(fit2)$r.squared
summary(fit2.2)$r.squared
plot(resid(fit2))
plot(resid(fit2))
nt = X1 * X2
plot(Int, resid(fit2))
plot(resid(fit2))
Int = X1 * X2
plot(Int, resid(fit2))
library(knitr)
knitr::opts_chunk$set(echo = TRUE)
data1 = read.table("job+proficiency.txt")
data1 = read.table("job+proficiency.txt")
names(data1)=c("Y","x1","x2","x3","x4")
lm.a=lm(Y~., data1)
library(leaps)
install.packages("leaps")
data1 = read.table("job+proficiency.txt")
names(data1)=c("Y","x1","x2","x3","x4")
lm.a=lm(Y~., data1)
library(leaps)
all<-regsubsets(Y~., data=data1,nbest=1)
best3 = order(summary(all)$adjr2)[1:4]
kable(cbind(summary(all)$which[best3,], adjr2=summary(all)$adjr2[best3]))
data1 = read.table("kidney+function.txt")
names(data1)=c("Y","x1","x2","x3")
data2=data.frame(Y=data1[,1],X1=data1[,2]-mean(x1),X2=data1[,3]-mean(x2),X3=data1[,4]-2.286957,X1_2=I((data1[,2]-mean(x1))^2),X2_2=I((data1[,3]-mean(x2))^2),X3_2=I((data1[,4]-2.286957)^2))
data1 = read.table("kidney+function.txt")
names(data1)=c("Y","x1","x2","x3")
data2=data.frame(Y=data1[,1],X1=data1[,2]-mean(X1),X2=data1[,3]-mean(x2),X3=data1[,4]-2.286957,X1_2=I((data1[,2]-mean(x1))^2),X2_2=I((data1[,3]-mean(x2))^2),X3_2=I((data1[,4]-2.286957)^2))
data1 = read.table("kidney+function.txt")
names(data1)=c("Y","x1","x2","x3")
data2=data.frame(Y=data1[,1],X1=data1[,2]-mean(X1),X2=data1[,3]-mean(X2),X3=data1[,4]-2.286957,X1_2=I((data1[,2]-mean(x1))^2),X2_2=I((data1[,3]-mean(x2))^2),X3_2=I((data1[,4]-2.286957)^2))
data1 = read.table("kidney+function.txt")
names(data1)=c("Y","x1","x2","x3")
data2=data.frame(Y=data1[,1],X1=data1[,2]-mean(X1),X2=data1[,3]-mean(X2),X3=data1[,4]-2.286957,X1_2=I((data1[,2]-mean(X1))^2),X2_2=I((data1[,3]-mean(X2))^2),X3_2=I((data1[,4]-2.286957)^2))
lm.a=lm(Y~., data2)
library(leaps)
all<-regsubsets(Y~., data=data2,nbest=1)
best3 = order(summary(all)$cp)[1:3]
library(knitr)
kable(cbind(summary(all)$which[best3,], cp=summary(all)$cp[best3]))
data1 = read.table("kidney+function.txt")
names(data1)=c("Y","x1","x2","x3")
data2=data.frame(Y=data1[,1],X1=data1[,2]-mean(X1),X2=data1[,3]-mean(X2),X3=data1[,4]-2.286957,X1_2=I((data1[,2]-mean(X1))^2),X2_2=I((data1[,3]-mean(X2))^2),X3_2=I((data1[,4]-2.286957)^2))
lm.a=lm(Y~., data2)
library(leaps)
all<-regsubsets(Y~., data=data2,nbest=1)
best3 = order(summary(all)$cp)[1:5]
library(knitr)
kable(cbind(summary(all)$which[best3,], cp=summary(all)$cp[best3]))
data1 = read.table("kidney+function.txt")
names(data1)=c("Y","x1","x2","x3")
data2=data.frame(Y=data1[,1],X1=data1[,2]-mean(X1),X2=data1[,3]-mean(X2),X3=data1[,4]-2.286957,X1_2=I((data1[,2]-mean(X1))^2),X2_2=I((data1[,3]-mean(X2))^2),X3_2=I((data1[,4]-2.286957)^2))
lm.a=lm(Y~., data2)
library(leaps)
all<-regsubsets(Y~., data=data2,nbest=1)
best3 = order(summary(all)$cp)[1:6]
library(knitr)
kable(cbind(summary(all)$which[best3,], cp=summary(all)$cp[best3]))
data1 = read.table("kidney+function.txt")
names(data1)=c("Y","x1","x2","x3")
data2=data.frame(Y=data1[,1],X1=data1[,2]-mean(X1),X2=data1[,3]-mean(X2),X3=data1[,4]-2.286957,X1_2=I((data1[,2]-mean(X1))^2),X2_2=I((data1[,3]-mean(X2))^2),X3_2=I((data1[,4]-2.286957)^2))
lm.a=lm(Y~., data2)
library(leaps)
all<-regsubsets(Y~., data=data2,nbest=1)
best6 = order(summary(all)$cp)[1:6]
library(knitr)
kable(cbind(summary(all)$which[best6,], cp=summary(all)$cp[best6]))
