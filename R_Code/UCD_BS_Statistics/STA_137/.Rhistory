knitr::opts_chunk$set(echo = TRUE)
library(readxl)
cars <- read_excel("USCrude1.xls")
library(readxl)
crude <- read_excel("USCrude1.xls")
library(readxl)
crude <- read_excel("USCrude1.xls")
head(crude)
library(readxl)
crude <- read_excel("USCrude1.xls", skip = 10)
head(crude)
library(readxl)
crude <- read_excel("USCrude1.xls", skip = 30)
head(crude)
library(readxl)
crude <- read_excel("USCrude1.xls", skip = 20)
head(crude)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2)
head(crude)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 1)
head(crude)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2)
head(crude)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2)
Y <- crude[,2]
head(crude)
head(Y)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2)
Y <- crude[,2]
t = 1:119
head(t)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2)
Y <- crude[,2]
tm = 1:119
loess(Y~tm,span=0.2)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2)
Y <- crude[,2]
tm = 1:119
loess(crude[,2]~tm,span=0.2)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2)
Y <- crude[,2]
tm = 1:119
loess(c(Y)~tm,span=0.2)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y <- crude[,2]
tm = 1:119
loess(~tm,span=0.2)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
tm = 1:119
loess(crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`~tm,span=0.2)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
loess(Y~tm,span=0.2)
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model$r.squared
library(readxl)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1990, y = Y))
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1990, y = Y)) + geom_point()
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1990, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x)
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1990, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green") + geom_point(aes(x = tm + 1900, y = Y - model), col = "red")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = log(Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = logy - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
library(readxl)
library(ggplot2)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
Xt = ylog - model$fitted
ggplot(data=model, aes(x=tm + 1900, y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
Xt = ylog - model$fitted
ggplot(data=crude, aes(x=tm + 1900, y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
Xt = ylog - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
Xt = ylog - model$fitted
ggplot(data=crude, aes(x=tm + 1900)) + geom_histogram(bins = 26, color = "black", fill = "white")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
Xt = ylog - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
#1c)
Xt = ylog - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
qqnorm(Xt)
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
#1c)
Xt = ylog - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
qqnorm(Xt)
qqline(Xt, col = "salmon")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
#1c)
Xt = ylog - model$fitted
Xt2 = y - model$fitted
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with log(Yt), as the points are mostly closer to the line in both graphs(the red graphs), than those with just Yt(green graphs)")
#1c)
Xt = ylog - model$fitted
Xt2 = Y - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
qqnorm(Xt)
qqline(Xt, col = "salmon")
qqnorm(Xt2)
qqline(Xt2, col = "salmon")
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with Yt only as points in the residual plot are more around 0 as opposed to fitting what seems like a nonlinear line with the log(Yt)")
#1c)
Xt = ylog - model$fitted
Xt2 = Y - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
qqnorm(Xt2)
qqline(Xt2, col = "salmon")
#1d)
acf(Xt)
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with Yt only as points in the residual plot are more around 0 as opposed to fitting what seems like a nonlinear line with the log(Yt)")
#1c)
Xt = ylog - model$fitted
Xt2 = Y - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
qqnorm(Xt2)
qqline(Xt2, col = "salmon")
#1d)
acf(Xt, lag.max = 10)
library(readxl)
library(ggplot2)
#1a)
crude <- read_excel("USCrude1.xls", sheet = 2, skip = 2, col_names = TRUE)
Y = crude$`U.S. Field Production of Crude Oil (Thousand Barrels)`
tm = 1:119
model = loess(Y~tm,span=0.2)
model
model$fitted
ggplot(crude, aes(x = tm + 1900, y = Y)) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "green")
ggplot(crude, aes(x = tm + 1900, y = Y - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "dark green")
#1b)
ylog = log(Y, base = exp(1))
ggplot(crude, aes(x = tm + 1900, y = log(Y, base = exp(1)))) + geom_point() + ggtitle("US Crude Oil Over Time") + xlab("Time") + ylab("Production(Thousand Barrels)") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "red")
ggplot(crude, aes(x = tm + 1900, y = ylog - model$fitted)) + geom_point() + ggtitle("Xt vs Time") + xlab("Time") + ylab("Xt") + geom_smooth(aes(group = 1), method="loess", formula=y~x, se = FALSE, col = "maroon")
cat("working with Yt only as points in the residual plot are more around 0 as opposed to fitting what seems like a nonlinear line with the log(Yt)")
#1c)
Xt = ylog - model$fitted
Xt2 = Y - model$fitted
ggplot(data=crude, aes(y = Xt)) + geom_histogram(bins = 26, color = "black", fill = "white")
qqnorm(Xt2)
qqline(Xt2, col = "salmon")
#1d)
acf(Xt, lag.max = 10)
#1e)
Box.test(Xt, type = "Ljung-Box")
#1e)
cat("Ho --> autocorrelations = 0, Ha --> autocorrections != 0
Decision Rule --> if p-value < 0.05, reject null")
Box.test(Xt, type = "Ljung-Box")
cat("as")
